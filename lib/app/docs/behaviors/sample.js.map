{"version":3,"sources":["/var/snap-ci/repo/src/app/docs/behaviors/sample.js"],"names":[],"mappings":"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","file":"/var/snap-ci/repo/src/app/docs/behaviors/sample.js","sourcesContent":["import {Behavior, Container} from 'aurelia-framework';\nimport {ViewCompiler, ViewResources, ViewSlot} from 'aurelia-templating';\nimport {ResourcePool} from 'app/resource-pool/services/resource-pool';\nimport Prism from 'prism';\nimport srcref from 'srcref.json!';\n\nSystem.config({\n  paths: {\n    'src:*': `${srcref.src}/*.js`,\n    'preview:*': `${srcref.view}/*.js`\n  }\n});\n\nconst hasTemplateElement = ('content' in document.createElement('template'));\n\nfunction empty(node) {\n  while (node.firstChild) {\n    node.removeChild(node.firstChild);\n  }\n}\n\nfunction resolvepath(path) {\n  for (let prefix in System.paths) {\n    const test = prefix.replace('*', '');\n    if (test.length === 0)\n      continue;\n    \n    const matches = path.substring(0, test.length) === test;\n    if (matches) {\n      return System.paths[prefix].replace('*.js', path.substring(test.length));\n    }\n  }\n\n  return path;\n}\n\nexport class SampleBehavior {\n  static metadata() {\n    return Behavior\n      .customElement('sample')\n      .withProperty('dir')\n      .skipContentProcessing()\n      .noView();\n  }\n\n  static inject() { return [Element, ResourcePool, ViewCompiler, ViewResources, ViewSlot, Container]; }\n  constructor(element, resourcePool, viewCompiler, viewResources, viewSlot, container) {\n    this.element = element;\n    this.resourcePool = resourcePool;\n    this.viewCompiler = viewCompiler;\n    this.viewResources = viewResources;\n    this.viewSlot = viewSlot;\n    this.container = container;\n    this.files = [\n      { id: './viewmodel',    ext: '.js',    name: 'viewmodel' },\n      { id: './template',     ext: '.html',  name: 'template'  }\n    ];\n\n\n    empty(this.element);\n  }\n\n  async bind(ctx) {\n    if (this.viewSlot.children.length)\n      return;\n\n    const viewUrl = this.viewResources.viewUrl;\n    const dir = this.dir ? (await System.normalize(this.dir + '/index', viewUrl)) : viewUrl;\n    const factory = await this.resourcePool.getAndFree(dir, 'sample', () => {\n      console.log('loading files');\n      return Promise.all(this.files.map(async ({id, ext, name}) => {\n        const mod = await System.normalize(id, dir);\n        const src = await System.import(`src:${mod}${ext}!text`);\n        const url = resolvepath(`preview:${mod}${ext}`);\n\n        let lang;\n        switch (ext) {\n          case '.js':   lang = Prism.languages.javascript; break;\n          case '.html': lang = Prism.languages.markup; break;\n          default: throw new Error(`Unknown extension: ${ext}`);\n        }\n\n        const highlight = Prism.highlight(src, lang);\n\n        return {name, mod, ext, src, highlight, url};\n      })).then(files => {\n        // Create HTML string\n        const html = files.map(file => {\n          return `\n            <div class=\"col-md-12\">\n              <a href=\"${file.url}\" target=\"_blank\">${file.name}</a>:\n              <pre class=\"language-${file.ext.substring(1)}\"><code>${file.highlight}</code></pre>\n            </div>\n          `;\n        }).join('');\n\n        const viewmodel = files.filter(f => f.name === 'viewmodel')[0].mod;\n        const template  = resolvepath(files.filter(f => f.name === 'template')[0].mod);\n        const compose = document.createElement('compose');\n        compose.setAttribute('view-model', viewmodel);\n        compose.setAttribute('view', template + '.html');\n\n        const wrap = document.createElement('div');\n        wrap.className = 'row preview';\n\n        const innerWrap = document.createElement('div');\n        innerWrap.className = 'col-md-24';\n        wrap.appendChild(innerWrap);\n\n        const resultText = document.createElement('strong');\n        resultText.innerText = 'result:';\n        innerWrap.appendChild(resultText);\n\n        const well = document.createElement('div');\n        well.className = 'well';\n        innerWrap.appendChild(well);\n        well.appendChild(compose);\n\n        const fragment = document.createDocumentFragment();\n        fragment.appendChild(wrap);\n        const viewFactory = this.viewCompiler.compile(fragment, this.viewResources);\n        const div = document.createElement('div');\n        div.innerHTML = html;\n        div.className = 'row';\n        fragment.insertBefore(div, wrap);\n        return viewFactory;\n      });\n    });\n\n    const view = factory.create(this.container, ctx);\n    this.viewSlot.add(view);\n  }\n}"]}